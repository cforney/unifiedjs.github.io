<!doctypehtml><html lang=en><meta charset=utf8><title>Narrow nodes in TypeScript - unified</title><meta content="width=device-width,initial-scale=1"name=viewport><link href=https://github.com rel=preconnect><link href=https://images.opencollective.com rel=preconnect><link href=/syntax-light.css rel=stylesheet><link href=/index.css rel=stylesheet><link href=/big.css rel=stylesheet media=(min-width:36em)><link href=/syntax-dark.css rel=stylesheet media=(prefers-color-scheme:dark)><link href=/dark.css rel=stylesheet media=(prefers-color-scheme:dark)><link href=https://unifiedjs.com/learn/recipe/narrow-node-typescript/ rel=canonical><meta content="How to narrow generic &#96Node&#96 to specific syntax types"name=description><meta content=recipe,typescript,unist,node,unified,parse,stringify,process,ast,transform name=keywords><meta content="Christian Murphy"name=author><meta content="© 2020 Christian Murphy"name=copyright><meta content=#0366d6 name=theme-color><meta content=article property=og:type><meta content=unified property=og:site_name><meta content=https://unifiedjs.com/learn/recipe/narrow-node-typescript/ property=og:url><meta content="Narrow nodes in TypeScript"property=og:title><meta content="How to narrow generic &#96Node&#96 to specific syntax types"property=og:description><meta content=https://unifiedjs.com/image/cover-1200.png property=og:image><meta content="We compile content to syntax trees and syntax trees to content. We also provide hundreds of packages to work on the trees in between. You can build on the unified collective to make all kinds of interesting things."property=og:image:alt><meta content=1200 property=og:image:width><meta content=690 property=og:image:height><meta content=2020-06-09T00:00:00.000Z property=article:published_time><meta content=2020-06-15T00:00:00.000Z property=article:modified_time><meta content=recipe property=article:tag><meta content=typescript property=article:tag><meta content=unist property=article:tag><meta content=node property=article:tag><meta content=summary_large_image name=twitter:card><meta content=https://unifiedjs.com/image/cover-1200.png name=twitter:image><meta content="We compile content to syntax trees and syntax trees to content. We also provide hundreds of packages to work on the trees in between. You can build on the unified collective to make all kinds of interesting things."name=twitter:image:alt><meta content=@unifiedjs name=twitter:site><script defer src=/houdini.js></script><script defer src=/search.js></script><div class=blm><div class=container><div class=row><p><a href=https://bailfunds.github.io>#</a><a href=https://www.gofundme.com/f/georgefloyd>Black</a><a href=https://www.gofundme.com/f/i-run-with-maud>Lives</a><a href=https://www.gofundme.com/f/justice-for-mike-ramos>Matter</a></div></div></div><header class=container><div class=row-l><h1><a href=/ class=unified><span class=hl>uni</span>fied</a></h1><nav class="flex row-l"aria-label="Main navigation"><ol class="row flex"><li><a href=/explore/>Explore</a><li><a href=/learn/>Learn</a><li><a href=/community/>Community</a></ol><ol class="row x-show-l justify-end-l"><li><a href=https://twitter.com/unifiedjs><svg class="x-show-l icon"height=24 viewBox="0 0 18 14"width=24 aria-label=Twitter role=img><path d="M18 1.684l-1.687 1.684v.28c0 .307-.05.602-.123.886-.04 2.316-.777 5.387-3.816 7.81C6.404 17.115 0 12.907 0 12.907c5.063 0 5.063-1.684 5.063-1.684-1.126 0-3.376-2.243-3.376-2.243.563.56 1.689 0 1.689 0C.56 7.295.56 5.61.56 5.61c.563.561 1.689 0 1.689 0C-.563 3.368 1.124.561 1.124.561 1.687 3.368 9 4.49 9 4.49l.093-.046A6.637 6.637 0 0 1 9 3.368C9 1.353 10.636 0 12.656 0c1.112 0 2.094.506 2.765 1.286l.329-.163L17.437 0l-1.122 2.245L18 1.684z"fill=currentcolor /></svg><span class=x-hide-l>Twitter</span></a><li><a href=https://github.com/unifiedjs><svg class="x-show-l icon"height=24 viewBox="0 0 16 16"width=24 aria-label=GitHub role=img><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"fill=currentcolor clip-rule=evenodd fill-rule=evenodd /></svg><span class=x-hide-l>GitHub</span></a></ol></nav></div></header><section class=container><div class="row-l column-l"><h2><a href=/learn/>Learn</a><span class="lowlight separator">/</span><a href=/learn/recipe/>Recipe</a><span class="lowlight separator">/</span><span class=content><a href=/learn/recipe/narrow-node-typescript/ rel=canonical>Narrow nodes in TypeScript</a></span></h2></div></section><main class=container><div class="content article"><h2 id=how-to-narrow-nodes-in-typescript><a href=#how-to-narrow-nodes-in-typescript class=anchor aria-label="Link to self"><svg class=icon height=18 viewBox="0 0 16 16"width=18 aria-hidden=true><path d="M7.775 3.275C7.64252 3.41717 7.57039 3.60522 7.57382 3.79952C7.57725 3.99382 7.65596 4.1792 7.79337 4.31662C7.93079 4.45403 8.11617 4.53274 8.31047 4.53617C8.50477 4.5396 8.69282 4.46748 8.835 4.335L10.085 3.085C10.2708 2.89918 10.4914 2.75177 10.7342 2.65121C10.977 2.55064 11.2372 2.49888 11.5 2.49888C11.7628 2.49888 12.023 2.55064 12.2658 2.65121C12.5086 2.75177 12.7292 2.89918 12.915 3.085C13.1008 3.27082 13.2482 3.49142 13.3488 3.7342C13.4493 3.97699 13.5011 4.23721 13.5011 4.5C13.5011 4.76279 13.4493 5.023 13.3488 5.26579C13.2482 5.50857 13.1008 5.72917 12.915 5.915L10.415 8.415C10.2292 8.60095 10.0087 8.74847 9.76588 8.84911C9.52308 8.94976 9.26283 9.00157 9 9.00157C8.73716 9.00157 8.47691 8.94976 8.23411 8.84911C7.99132 8.74847 7.77074 8.60095 7.585 8.415C7.44282 8.28252 7.25477 8.21039 7.06047 8.21382C6.86617 8.21725 6.68079 8.29596 6.54337 8.43337C6.40596 8.57079 6.32725 8.75617 6.32382 8.95047C6.32039 9.14477 6.39252 9.33282 6.525 9.475C6.85001 9.80004 7.23586 10.0579 7.66052 10.2338C8.08518 10.4097 8.54034 10.5002 9 10.5002C9.45965 10.5002 9.91481 10.4097 10.3395 10.2338C10.7641 10.0579 11.15 9.80004 11.475 9.475L13.975 6.975C14.6314 6.31858 15.0002 5.4283 15.0002 4.5C15.0002 3.57169 14.6314 2.68141 13.975 2.025C13.3186 1.36858 12.4283 0.999817 11.5 0.999817C10.5717 0.999817 9.68141 1.36858 9.02499 2.025L7.775 3.275ZM3.085 12.915C2.89904 12.7292 2.75152 12.5087 2.65088 12.2659C2.55023 12.0231 2.49842 11.7628 2.49842 11.5C2.49842 11.2372 2.55023 10.9769 2.65088 10.7341C2.75152 10.4913 2.89904 10.2707 3.085 10.085L5.585 7.585C5.77074 7.39904 5.99132 7.25152 6.23411 7.15088C6.47691 7.05023 6.73716 6.99842 7 6.99842C7.26283 6.99842 7.52308 7.05023 7.76588 7.15088C8.00867 7.25152 8.22925 7.39904 8.415 7.585C8.55717 7.71748 8.74522 7.7896 8.93952 7.78617C9.13382 7.78274 9.3192 7.70403 9.45662 7.56662C9.59403 7.4292 9.67274 7.24382 9.67617 7.04952C9.6796 6.85522 9.60748 6.66717 9.475 6.525C9.14999 6.19995 8.76413 5.94211 8.33947 5.7662C7.91481 5.59029 7.45965 5.49974 7 5.49974C6.54034 5.49974 6.08518 5.59029 5.66052 5.7662C5.23586 5.94211 4.85001 6.19995 4.525 6.525L2.025 9.02499C1.36858 9.68141 0.999817 10.5717 0.999817 11.5C0.999817 12.4283 1.36858 13.3186 2.025 13.975C2.68141 14.6314 3.57169 15.0002 4.5 15.0002C5.4283 15.0002 6.31858 14.6314 6.975 13.975L8.225 12.725C8.35748 12.5828 8.4296 12.3948 8.42617 12.2005C8.42274 12.0062 8.34403 11.8208 8.20662 11.6834C8.0692 11.546 7.88382 11.4672 7.68952 11.4638C7.49522 11.4604 7.30717 11.5325 7.165 11.665L5.915 12.915C5.72925 13.1009 5.50867 13.2485 5.26588 13.3491C5.02308 13.4498 4.76283 13.5016 4.5 13.5016C4.23716 13.5016 3.97691 13.4498 3.73411 13.3491C3.49132 13.2485 3.27074 13.1009 3.085 12.915Z"fill=currentcolor /></svg></a>How to narrow <code>Node</code>s in TypeScript</h2><p>To work with a specific node type or a set of node types we need to <a href=https://www.typescriptlang.org/docs/handbook/2/narrowing.html rel="nofollow noopener noreferrer">narrow</a> their type. For example, we can take a <code>Node</code> and do a type safe check to get a more specific type like a <code>Link</code>. <a href=/explore/package/unified/ class=unified><span class=hl>uni</span>fied</a> provides a utility to help with this. TypeScript also provides some language features that can help. Let’s first take a look at <code>unist-util-is</code>.<p><a href=/explore/package/unist-util-is/><code>unist-util-is</code></a> takes a <code>Node</code> and a <code>Test</code> and returns whether the test passes. It can be used as a <a href=https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates rel="nofollow noopener noreferrer">TypeScript type predicate</a> which when used as a condition (such as in an if-statement) tells TypeScript to narrow a node.<p>Here are some ways to narrow nodes:<pre><code class="hljs language-ts"><span class=hljs-keyword>import</span> <span class=hljs-keyword>type</span> {<span class="hljs-title class_">Node</span>, <span class="hljs-title class_">Literal</span>} <span class=hljs-keyword>from</span> <span class=hljs-string>'unist'</span>
<span class=hljs-keyword>import</span> <span class=hljs-keyword>type</span> {<span class="hljs-title class_">List</span>, <span class="hljs-title class_">Blockquote</span>, <span class="hljs-title class_">Strong</span>, <span class="hljs-title class_">Emphasis</span>, <span class="hljs-title class_">Heading</span>} <span class=hljs-keyword>from</span> <span class=hljs-string>'mdast'</span>
<span class=hljs-keyword>import</span> {is, convert} <span class=hljs-keyword>from</span> <span class=hljs-string>'unist-util-is'</span>

<span class=hljs-comment>// `Node` could come from a plugin, a utility, or be passed into a function</span>
<span class=hljs-comment>// here we hard code a Node for testing purposes</span>
<span class=hljs-keyword>const</span> <span class=hljs-attr>node</span>: <span class="hljs-title class_">Node</span> = {<span class=hljs-attr>type</span>: <span class=hljs-string>'example'</span>}

<span class=hljs-keyword>if</span> (is&lt;<span class="hljs-title class_">List</span>>(node, <span class=hljs-string>'list'</span>)) {
  <span class=hljs-comment>// If we’re here, node is List.</span>
  <span class=hljs-comment>//</span>
  <span class=hljs-comment>// `'list'` is compared to `node.type` to make sure they match.</span>
  <span class=hljs-comment>// `true` means a match, `false` means no match.</span>
  <span class=hljs-comment>//</span>
  <span class=hljs-comment>// `&#60List>` tells TypeScript to ensure `'list'` matches `List.type` and that</span>
  <span class=hljs-comment>// if `'list'` matches both `node.type` and `List.type`, we know that node is</span>
  <span class=hljs-comment>// `List` within this if condition.</span>
}

<span class=hljs-keyword>if</span> (is&lt;<span class="hljs-title class_">Strong</span> | <span class="hljs-title class_">Emphasis</span>>(node, [<span class=hljs-string>'strong'</span>, <span class=hljs-string>'emphasis'</span>])) {
  <span class=hljs-comment>// If we get here, node is `Strong` or `Emphasis`.</span>

  <span class=hljs-comment>// If we want even more specific type, we can use a discriminated union</span>
  <span class=hljs-comment>// &#60https://www.typescriptlang.org/docs/handbook/2/narrowing.html#discriminated-unions></span>
  <span class=hljs-keyword>if</span> (node.<span class=hljs-property>type</span> === <span class=hljs-string>'emphasis'</span>) {
    <span class=hljs-comment>// If we get here, node is `Emphasis`.</span>
  }
}

<span class=hljs-keyword>if</span> (is&lt;<span class="hljs-title class_">Heading</span>>(node, {<span class=hljs-attr>type</span>: <span class=hljs-string>'heading'</span>, <span class=hljs-attr>depth</span>: <span class=hljs-number>1</span>})) {
  <span class=hljs-comment>// If we get here, node is `Heading`.</span>
  <span class=hljs-comment>//</span>
  <span class=hljs-comment>// TypeScript checks that the properties used in the `Test` are valid</span>
  <span class=hljs-comment>// attributes of `&#60Heading>`.</span>
  <span class=hljs-comment>//</span>
  <span class=hljs-comment>// It does not narrow `node.depth` only be 1, which can be done with</span>
  <span class=hljs-comment>// `&#60Heading &#38 {depth: 1}>`.</span>
}

<span class=hljs-comment>// For advanced use cases, another predicate can be passed to `is`</span>
<span class=hljs-keyword>if</span> (is&lt;<span class="hljs-title class_">Literal</span>>(node, (<span class=hljs-attr>node</span>: <span class="hljs-title class_">Node</span>): node is <span class="hljs-title class_">Literal</span> => <span class=hljs-string>'value'</span> <span class=hljs-keyword>in</span> node)) {
  <span class=hljs-comment>// If we get here, node is one of the `Literal` types.</span>
  <span class=hljs-comment>//</span>
  <span class=hljs-comment>// Here any comparison function can be used, as long as it is a predicate</span>
  <span class=hljs-comment>// &#60https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates></span>
  <span class=hljs-comment>// and as long as the predicate and generic match.</span>
  <span class=hljs-comment>// For example here, `&#60Literal>` and `is Literal` match.</span>
}

<span class=hljs-comment>// Reusable predicates can also be created using any `Test`</span>
<span class=hljs-keyword>const</span> isBlockquote = convert&lt;<span class="hljs-title class_">Blockquote</span>>(<span class=hljs-string>'blockquote'</span>)
<span class=hljs-keyword>if</span> (<span class="hljs-title function_">isBlockquote</span>(node)) {
  <span class=hljs-comment>// If we get here, node is `Blockquote`.</span>
}
</code></pre></div></main><footer class=container><nav class="flex row-l"><ol class="row flex x-show-l"><li><a href=/ class=unified><span class=hl>uni</span>fied</a><li><a href=/explore/>Explore</a><li><a href=/learn/>Learn</a><li><a href=/community/>Community</a></ol><ol class="row justify-end-l"><li><a href=https://opencollective.com/unified>OpenCollective</a><li><a href=https://twitter.com/unifiedjs>Twitter</a><li><a href=https://github.com/unifiedjs>GitHub</a></ol></nav></footer>